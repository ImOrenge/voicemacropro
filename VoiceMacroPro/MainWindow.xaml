<Window x:Class="VoiceMacroPro.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="VoiceMacro Pro - ê²Œìž„ AI ìŒì„± ë§¤í¬ë¡œ" 
        Height="700" Width="1200"
        WindowStartupLocation="CenterScreen">
    
    <!-- ë©”ì¸ ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ -->
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- ìƒë‹¨ ì œëª© ì˜ì—­ -->
        <Border Grid.Row="0" Background="#2C3E50" Padding="20,10">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="ðŸŽ® VoiceMacro Pro" 
                          FontSize="24" 
                          FontWeight="Bold" 
                          Foreground="White" 
                          VerticalAlignment="Center"/>
                <TextBlock Text="ë§¤í¬ë¡œ ê´€ë¦¬ ì‹œìŠ¤í…œ" 
                          FontSize="16" 
                          Foreground="#BDC3C7" 
                          VerticalAlignment="Center" 
                          Margin="20,0,0,0"/>
            </StackPanel>
        </Border>
        
        <!-- ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
        <TabControl Grid.Row="1" Background="#ECF0F1" Margin="10">
            
            <!-- ë§¤í¬ë¡œ ê´€ë¦¬ íƒ­ -->
            <TabItem Header="ðŸ“‹ ë§¤í¬ë¡œ ê´€ë¦¬" FontSize="14" Padding="15,10">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- ê²€ìƒ‰ ë° í•„í„° ì˜ì—­ -->
                    <Border Grid.Row="0" Background="White" Padding="15" Margin="0,0,0,10" CornerRadius="5">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- ê²€ìƒ‰ ë°•ìŠ¤ -->
                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                <TextBlock Text="ðŸ” ê²€ìƒ‰:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <TextBox Name="SearchTextBox" 
                                        Width="300" 
                                        Height="30" 
                                        VerticalContentAlignment="Center"
                                        Text="{Binding SearchTerm, UpdateSourceTrigger=PropertyChanged}"
                                        FontSize="14"/>
                                <Button Name="SearchButton" 
                                       Content="ê²€ìƒ‰" 
                                       Margin="10,0,0,0" 
                                       Padding="15,5" 
                                       Background="#3498DB" 
                                       Foreground="White" 
                                       BorderThickness="0"
                                       Click="SearchButton_Click"/>
                            </StackPanel>
                            
                            <!-- ì •ë ¬ ì˜µì…˜ -->
                            <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="20,0,0,0">
                                <TextBlock Text="ì •ë ¬:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <ComboBox Name="SortComboBox" 
                                         Width="120" 
                                         Height="30"
                                         SelectedIndex="0"
                                         SelectionChanged="SortComboBox_SelectionChanged">
                                    <ComboBoxItem Content="ì´ë¦„ìˆœ" Tag="name"/>
                                    <ComboBoxItem Content="ìƒì„±ì¼ìˆœ" Tag="created_at"/>
                                    <ComboBoxItem Content="ì‚¬ìš©ë¹ˆë„ìˆœ" Tag="usage_count"/>
                                </ComboBox>
                            </StackPanel>
                            
                            <!-- ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ -->
                            <Button Grid.Column="2" 
                                   Name="RefreshButton"
                                   Content="ðŸ”„ ìƒˆë¡œê³ ì¹¨" 
                                   Margin="20,0,0,0" 
                                   Padding="15,5" 
                                   Background="#27AE60" 
                                   Foreground="White" 
                                   BorderThickness="0"
                                   Click="RefreshButton_Click"/>
                        </Grid>
                    </Border>
                    
                    <!-- ë²„íŠ¼ ê·¸ë£¹ -->
                    <Border Grid.Row="1" Background="White" Padding="15" Margin="0,0,0,10" CornerRadius="5">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                            <Button Name="AddMacroButton" 
                                   Content="âž• ìƒˆ ë§¤í¬ë¡œ ì¶”ê°€" 
                                   Margin="0,0,10,0" 
                                   Padding="15,8" 
                                   Background="#2ECC71" 
                                   Foreground="White" 
                                   BorderThickness="0"
                                   FontWeight="Bold"
                                   Click="AddMacroButton_Click"/>
                            <Button Name="EditMacroButton" 
                                   Content="âœï¸ ìˆ˜ì •" 
                                   Margin="0,0,10,0" 
                                   Padding="15,8" 
                                   Background="#F39C12" 
                                   Foreground="White" 
                                   BorderThickness="0"
                                   IsEnabled="False"
                                   Click="EditMacroButton_Click"/>
                            <Button Name="CopyMacroButton" 
                                   Content="ðŸ“‹ ë³µì‚¬" 
                                   Margin="0,0,10,0" 
                                   Padding="15,8" 
                                   Background="#3498DB" 
                                   Foreground="White" 
                                   BorderThickness="0"
                                   IsEnabled="False"
                                   Click="CopyMacroButton_Click"/>
                            <Button Name="DeleteMacroButton" 
                                   Content="ðŸ—‘ï¸ ì‚­ì œ" 
                                   Margin="0,0,10,0" 
                                   Padding="15,8" 
                                   Background="#E74C3C" 
                                   Foreground="White" 
                                   BorderThickness="0"
                                   IsEnabled="False"
                                   Click="DeleteMacroButton_Click"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- ë§¤í¬ë¡œ ëª©ë¡ DataGrid -->
                    <Border Grid.Row="2" Background="White" CornerRadius="5">
                        <DataGrid Name="MacroDataGrid" 
                                 AutoGenerateColumns="False"
                                 CanUserAddRows="False"
                                 CanUserDeleteRows="False"
                                 CanUserResizeRows="False"
                                 SelectionMode="Single"
                                 GridLinesVisibility="Horizontal"
                                 HeadersVisibility="Column"
                                 AlternatingRowBackground="#F8F9FA"
                                 RowBackground="White"
                                 BorderThickness="0"
                                 FontSize="12"
                                 SelectionChanged="MacroDataGrid_SelectionChanged">
                            
                            <!-- ì»¬ëŸ¼ ì •ì˜ -->
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ID" 
                                                   Binding="{Binding Id}" 
                                                   Width="60" 
                                                   IsReadOnly="True"/>
                                <DataGridTextColumn Header="ë§¤í¬ë¡œ ì´ë¦„" 
                                                   Binding="{Binding Name}" 
                                                   Width="200" 
                                                   IsReadOnly="True"/>
                                <DataGridTextColumn Header="ìŒì„± ëª…ë ¹ì–´" 
                                                   Binding="{Binding VoiceCommand}" 
                                                   Width="200" 
                                                   IsReadOnly="True"/>
                                <DataGridTextColumn Header="ë™ìž‘ ì„¤ëª…" 
                                                   Binding="{Binding KeySequence}" 
                                                   Width="250" 
                                                   IsReadOnly="True"/>
                                <DataGridTextColumn Header="íƒ€ìž…" 
                                                   Binding="{Binding ActionType}" 
                                                   Width="100" 
                                                   IsReadOnly="True"/>
                                <DataGridTextColumn Header="ìƒì„±ì¼" 
                                                   Binding="{Binding CreatedAt, StringFormat={}{0:yyyy-MM-dd}}" 
                                                   Width="100" 
                                                   IsReadOnly="True"/>
                                <DataGridTextColumn Header="ì‚¬ìš© íšŸìˆ˜" 
                                                   Binding="{Binding UsageCount}" 
                                                   Width="100" 
                                                   IsReadOnly="True"/>
                            </DataGrid.Columns>
                            
                            <!-- í–‰ ìŠ¤íƒ€ì¼ -->
                            <DataGrid.RowStyle>
                                <Style TargetType="DataGridRow">
                                    <Setter Property="Height" Value="35"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#E8F6F3"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#3498DB"/>
                                            <Setter Property="Foreground" Value="White"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGrid.RowStyle>
                            
                            <!-- í—¤ë” ìŠ¤íƒ€ì¼ -->
                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="#34495E"/>
                                    <Setter Property="Foreground" Value="White"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                    <Setter Property="Padding" Value="10,8"/>
                                    <Setter Property="BorderThickness" Value="0,0,1,0"/>
                                    <Setter Property="BorderBrush" Value="#2C3E50"/>
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                        </DataGrid>
                    </Border>
                </Grid>
            </TabItem>
            
            <!-- PRD 3.5 ë¡œê·¸ ë° ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ -->
            <TabItem Header="ðŸ“Š ë¡œê·¸ ë° ëª¨ë‹ˆí„°ë§" FontSize="14" Padding="15,10">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- ë¡œê·¸ ì œì–´ íŒ¨ë„ -->
                    <Border Grid.Row="0" Background="White" Padding="15" Margin="0,0,0,10" CornerRadius="5">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- ë¡œê·¸ ë ˆë²¨ ì„ íƒ -->
                            <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0,0,20,0">
                                <TextBlock Text="ë¡œê·¸ ë ˆë²¨:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <ComboBox Name="LogLevelComboBox" 
                                         Width="100" 
                                         Height="30"
                                         SelectedIndex="1"
                                         SelectionChanged="LogLevelComboBox_SelectionChanged">
                                    <ComboBoxItem Content="Debug" Tag="Debug"/>
                                    <ComboBoxItem Content="Info" Tag="Info"/>
                                    <ComboBoxItem Content="Warning" Tag="Warning"/>
                                    <ComboBoxItem Content="Error" Tag="Error"/>
                                </ComboBox>
                            </StackPanel>
                            
                            <!-- í•„í„° ê²€ìƒ‰ë°•ìŠ¤ -->
                            <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="0,0,20,0">
                                <TextBlock Text="í•„í„°:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <TextBox Name="LogFilterTextBox" 
                                        Width="200" 
                                        Height="30" 
                                        VerticalContentAlignment="Center"
                                        FontSize="14"
                                        TextChanged="LogFilterTextBox_TextChanged"/>
                            </StackPanel>
                            
                            <!-- ìžë™ ìŠ¤í¬ë¡¤ ì²´í¬ë°•ìŠ¤ -->
                            <CheckBox Grid.Column="2" 
                                     Name="AutoScrollCheckBox"
                                     Content="ìžë™ ìŠ¤í¬ë¡¤" 
                                     VerticalAlignment="Center"
                                     IsChecked="True"
                                     Checked="AutoScrollCheckBox_Checked"
                                     Unchecked="AutoScrollCheckBox_Unchecked"/>
                            
                            <!-- ë¡œê·¸ ê´€ë¦¬ ë²„íŠ¼ë“¤ -->
                            <Button Grid.Column="3" 
                                   Name="ExportLogButton"
                                   Content="ðŸ“ ë¡œê·¸ ì €ìž¥" 
                                   Margin="10,0,0,0" 
                                   Padding="15,5" 
                                   Background="#17A2B8" 
                                   Foreground="White" 
                                   BorderThickness="0"
                                   Click="ExportLogButton_Click"/>
                            
                            <Button Grid.Column="4" 
                                   Name="ClearLogButton"
                                   Content="ðŸ—‘ï¸ ë¡œê·¸ ì§€ìš°ê¸°" 
                                   Margin="10,0,0,0" 
                                   Padding="15,5" 
                                   Background="#DC3545" 
                                   Foreground="White" 
                                   BorderThickness="0"
                                   Click="ClearLogButton_Click"/>
                            
                            <!-- ë¡œê·¸ í†µê³„ -->
                            <TextBlock Grid.Column="5" 
                                      Name="LogCountTextBlock"
                                      Text="ì´ 0ê°œ ë¡œê·¸" 
                                      VerticalAlignment="Center" 
                                      Margin="20,0,0,0"
                                      FontWeight="Bold"/>
                        </Grid>
                    </Border>
                    
                    <!-- ì‹¤ì‹œê°„ ë¡œê·¸ ì¶œë ¥ì°½ -->
                    <Border Grid.Row="1" Background="White" CornerRadius="5">
                        <DataGrid Name="LogDataGrid" 
                                 AutoGenerateColumns="False"
                                 CanUserAddRows="False"
                                 CanUserDeleteRows="False"
                                 CanUserResizeRows="False"
                                 SelectionMode="Single"
                                 GridLinesVisibility="Horizontal"
                                 HeadersVisibility="Column"
                                 AlternatingRowBackground="#F8F9FA"
                                 RowBackground="White"
                                 BorderThickness="0"
                                 FontSize="11"
                                 FontFamily="Consolas, Monaco, 'Courier New', monospace">
                            
                            <!-- ë¡œê·¸ ì»¬ëŸ¼ ì •ì˜ -->
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ì‹œê°„" 
                                                   Binding="{Binding TimeText}" 
                                                   Width="100" 
                                                   IsReadOnly="True"/>
                                <DataGridTextColumn Header="ë ˆë²¨" 
                                                   Binding="{Binding LevelText}" 
                                                   Width="80" 
                                                   IsReadOnly="True">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Foreground" Value="{Binding LevelColor}"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="ë©”ì‹œì§€" 
                                                   Binding="{Binding Message}" 
                                                   Width="*" 
                                                   IsReadOnly="True"/>
                                <DataGridTextColumn Header="ë§¤í¬ë¡œ ID" 
                                                   Binding="{Binding MacroId}" 
                                                   Width="80" 
                                                   IsReadOnly="True"/>
                            </DataGrid.Columns>
                            
                            <!-- ë¡œê·¸ í–‰ ìŠ¤íƒ€ì¼ -->
                            <DataGrid.RowStyle>
                                <Style TargetType="DataGridRow">
                                    <Setter Property="Height" Value="25"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#E3F2FD"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#2196F3"/>
                                            <Setter Property="Foreground" Value="White"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGrid.RowStyle>
                            
                            <!-- ë¡œê·¸ í—¤ë” ìŠ¤íƒ€ì¼ -->
                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="#37474F"/>
                                    <Setter Property="Foreground" Value="White"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                    <Setter Property="Padding" Value="8,6"/>
                                    <Setter Property="BorderThickness" Value="0,0,1,0"/>
                                    <Setter Property="BorderBrush" Value="#263238"/>
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                        </DataGrid>
                    </Border>
                    
                    <!-- í•˜ë‹¨ í†µê³„ íŒ¨ë„ -->
                    <Border Grid.Row="2" Background="White" Padding="15" Margin="0,10,0,0" CornerRadius="5">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- ì„±ëŠ¥ í†µê³„ í‘œì‹œ (í–¥í›„ êµ¬í˜„) -->
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="ë§¤í¬ë¡œ ì‹¤í–‰ ì„±ê³µë¥ " FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBlock Name="MacroSuccessRateTextBlock" Text="100%" FontSize="24" Foreground="#4CAF50"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1">
                                <TextBlock Text="ìŒì„± ì¸ì‹ ì •í™•ë„" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBlock Name="VoiceAccuracyTextBlock" Text="95%" FontSize="24" Foreground="#2196F3"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="2">
                                <TextBlock Text="ì‹œìŠ¤í…œ ìƒíƒœ" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBlock Name="SystemStatusTextBlock" Text="ì •ìƒ" FontSize="24" Foreground="#4CAF50"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>
            
            <TabItem Header="âš™ï¸ ë§¤í¬ë¡œ ì„¤ì •" FontSize="14" Padding="15,10">
                <Grid>
                    <TextBlock Text="ë§¤í¬ë¡œ ì„¤ì • ê¸°ëŠ¥ (ì¶”í›„ êµ¬í˜„ ì˜ˆì •)" 
                              HorizontalAlignment="Center" 
                              VerticalAlignment="Center" 
                              FontSize="16" 
                              Foreground="#7F8C8D"/>
                </Grid>
            </TabItem>
            
            <TabItem Header="ðŸ“ í”„ë¦¬ì…‹ ê´€ë¦¬" FontSize="14" Padding="15,10">
                <Grid>
                    <TextBlock Text="í”„ë¦¬ì…‹ ê´€ë¦¬ ê¸°ëŠ¥ (ì¶”í›„ êµ¬í˜„ ì˜ˆì •)" 
                              HorizontalAlignment="Center" 
                              VerticalAlignment="Center" 
                              FontSize="16" 
                              Foreground="#7F8C8D"/>
                </Grid>
            </TabItem>
            
            <TabItem Header="ðŸ“Š ë¡œê·¸ ë° ëª¨ë‹ˆí„°ë§" FontSize="14" Padding="15,10">
                <Grid>
                    <TextBlock Text="ë¡œê·¸ ë° ëª¨ë‹ˆí„°ë§ ê¸°ëŠ¥ (ì¶”í›„ êµ¬í˜„ ì˜ˆì •)" 
                              HorizontalAlignment="Center" 
                              VerticalAlignment="Center" 
                              FontSize="16" 
                              Foreground="#7F8C8D"/>
                </Grid>
            </TabItem>
        </TabControl>
        
        <!-- í•˜ë‹¨ ìƒíƒœ í‘œì‹œì¤„ -->
        <Border Grid.Row="2" Background="#34495E" Padding="15,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Name="StatusTextBlock" 
                          Grid.Column="0"
                          Text="ì¤€ë¹„" 
                          Foreground="White" 
                          VerticalAlignment="Center"/>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Ellipse Name="ServerStatusIndicator" 
                            Width="12" 
                            Height="12" 
                            Fill="Red" 
                            Margin="0,0,8,0"/>
                    <TextBlock Name="ServerStatusText" 
                              Text="ì„œë²„ ì—°ê²° í™•ì¸ ì¤‘..." 
                              Foreground="White" 
                              VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window> 