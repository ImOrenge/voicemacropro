---
description:
globs:
alwaysApply: false
---
# API í†µí•© ë° í†µì‹  ê°€ì´ë“œ

## ğŸŒ API ì•„í‚¤í…ì²˜ ê°œìš”
VoiceMacro ProëŠ” Python Flask ë°±ì—”ë“œì™€ C# WPF í”„ë¡ íŠ¸ì—”ë“œ ê°„ì˜ HTTP API í†µì‹ ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

## ğŸ”§ ë°±ì—”ë“œ API êµ¬ì¡°

### API ì„œë²„
- **ë©”ì¸ ì„œë²„**: [backend/api/server.py](mdc:backend/api/server.py) - Flask ê¸°ë°˜ REST API ì„œë²„
- **ì„œë²„ ì‹¤í–‰**: [run_server.py](mdc:run_server.py) - ê°œë°œí™˜ê²½ ì„œë²„ ì‹œì‘ì 
- **ë°°ì¹˜ ì‹¤í–‰**: [start_server.bat](mdc:start_server.bat) - Windows ë°°ì¹˜ íŒŒì¼

### í•µì‹¬ ì„œë¹„ìŠ¤ API
- **ë§¤í¬ë¡œ ì„œë¹„ìŠ¤**: [backend/services/macro_service.py](mdc:backend/services/macro_service.py)
  - ë§¤í¬ë¡œ CRUD ì‘ì—…
  - ë§¤í¬ë¡œ ì‹¤í–‰ ë° ê´€ë¦¬
  
- **ìŒì„± ì„œë¹„ìŠ¤**: [backend/services/voice_service.py](mdc:backend/services/voice_service.py)
  - ìŒì„± ì¸ì‹ ì²˜ë¦¬
  - Whisper AI í†µí•©
  
- **ë§¤í¬ë¡œ ë§¤ì¹­**: [backend/services/macro_matching_service.py](mdc:backend/services/macro_matching_service.py)
  - ìŒì„± ëª…ë ¹ì–´ì™€ ë§¤í¬ë¡œ ë§¤ì¹­
  - ìœ ì‚¬ë„ ê¸°ë°˜ ê²€ìƒ‰

## ğŸ”— í”„ë¡ íŠ¸ì—”ë“œ API í†µì‹ 

### API ì„œë¹„ìŠ¤ í´ë˜ìŠ¤
- **ApiService**: [VoiceMacroPro/Services/ApiService.cs](mdc:VoiceMacroPro/Services/ApiService.cs)
  - HTTP í´ë¼ì´ì–¸íŠ¸ ë˜í¼
  - API ì—”ë“œí¬ì¸íŠ¸ ì¶”ìƒí™”
  - ì˜¤ë¥˜ ì²˜ë¦¬ ë° ì¬ì‹œë„ ë¡œì§

### ì‚¬ìš© ì˜ˆì‹œ
```csharp
// ë§¤í¬ë¡œ ëª©ë¡ ì¡°íšŒ
var macros = await ApiService.GetMacrosAsync();

// ìƒˆ ë§¤í¬ë¡œ ìƒì„±
var newMacro = new Macro { Name = "í…ŒìŠ¤íŠ¸", VoiceCommand = "ê³µê²©" };
await ApiService.CreateMacroAsync(newMacro);

// ìŒì„± ì¸ì‹ ìš”ì²­
var result = await ApiService.RecognizeVoiceAsync(audioData);
```

## ğŸ“¡ API ì—”ë“œí¬ì¸íŠ¸ ëª…ì„¸

### ë§¤í¬ë¡œ ê´€ë¦¬ API
```
GET    /api/macros           # ë§¤í¬ë¡œ ëª©ë¡ ì¡°íšŒ
GET    /api/macros/{id}      # íŠ¹ì • ë§¤í¬ë¡œ ì¡°íšŒ  
POST   /api/macros           # ìƒˆ ë§¤í¬ë¡œ ìƒì„±
PUT    /api/macros/{id}      # ë§¤í¬ë¡œ ìˆ˜ì •
DELETE /api/macros/{id}      # ë§¤í¬ë¡œ ì‚­ì œ
POST   /api/macros/{id}/execute  # ë§¤í¬ë¡œ ì‹¤í–‰
```

### ìŒì„± ì¸ì‹ API
```
POST   /api/voice/recognize      # ìŒì„± íŒŒì¼ ì¸ì‹
POST   /api/voice/match-command  # ìŒì„±ê³¼ ë§¤í¬ë¡œ ë§¤ì¹­
GET    /api/voice/status         # ìŒì„± ì¸ì‹ ìƒíƒœ
```

### ì»¤ìŠ¤í…€ ìŠ¤í¬ë¦½íŒ… API
```
POST   /api/scripts/parse        # MSL ìŠ¤í¬ë¦½íŠ¸ íŒŒì‹±
POST   /api/scripts/execute      # ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
POST   /api/scripts/validate     # ìŠ¤í¬ë¦½íŠ¸ ìœ íš¨ì„± ê²€ì‚¬
```

## ğŸ› ï¸ ê°œë°œ ë° í…ŒìŠ¤íŠ¸

### ì„œë²„ ì‹œì‘ ë°©ë²•
```bash
# Pythonìœ¼ë¡œ ì§ì ‘ ì‹¤í–‰
py run_server.py

# ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰ (Windows)
start_server.bat
```

### API í…ŒìŠ¤íŠ¸ ë„êµ¬
- **í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸**: [backend/tests/test_api_response.py](mdc:backend/tests/test_api_response.py)
- **C# API í…ŒìŠ¤íŠ¸**: [backend/tests/test_csharp_api_call.py](mdc:backend/tests/test_csharp_api_call.py)
- **í†µí•© í…ŒìŠ¤íŠ¸**: [backend/tests/test_complete_pipeline.py](mdc:backend/tests/test_complete_pipeline.py)

### API ì‘ë‹µ í˜•ì‹
```json
{
  "success": true,
  "data": { ... },
  "message": "ì„±ê³µ ë©”ì‹œì§€",
  "error": null,
  "timestamp": "2025-01-18T10:30:00Z"
}
```

## ğŸš¨ ì˜¤ë¥˜ ì²˜ë¦¬ ê°€ì´ë“œ

### ì¼ë°˜ì ì¸ API ì˜¤ë¥˜
- **404**: ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ
- **400**: ì˜ëª»ëœ ìš”ì²­ ë°ì´í„°
- **500**: ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜
- **503**: ì„œë¹„ìŠ¤ ì¼ì‹œ ë¶ˆê°€

### C# ì˜¤ë¥˜ ì²˜ë¦¬ íŒ¨í„´
```csharp
try
{
    var result = await ApiService.GetMacrosAsync();
    // ì„±ê³µ ì²˜ë¦¬
}
catch (HttpRequestException ex)
{
    // ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜
    UIHelper.ShowError($"ì„œë²„ ì—°ê²° ì‹¤íŒ¨: {ex.Message}");
}
catch (ApiException ex)
{
    // API ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì˜¤ë¥˜
    UIHelper.ShowError($"API ì˜¤ë¥˜: {ex.Message}");
}
```

## ğŸ”’ ë³´ì•ˆ ë° ì¸ì¦

### í˜„ì¬ êµ¬í˜„
- ë¡œì»¬ ì„œë²„ í†µì‹  (127.0.0.1)
- ê¸°ë³¸ HTTP í”„ë¡œí† ì½œ
- ì¸ì¦ ì‹œìŠ¤í…œ ë¯¸êµ¬í˜„ (í–¥í›„ í™•ì¥ ì˜ˆì •)

### í–¥í›„ ë³´ì•ˆ ê°•í™” ê³„íš
- HTTPS í”„ë¡œí† ì½œ ì ìš©
- JWT í† í° ê¸°ë°˜ ì¸ì¦
- API í‚¤ ê¸°ë°˜ ì ‘ê·¼ ì œì–´
- ìš”ì²­ ì†ë„ ì œí•œ (Rate Limiting)

## ğŸ“Š ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

### ë¡œê¹… ì‹œìŠ¤í…œ
- **ë¡œê¹… ì„œë¹„ìŠ¤**: [VoiceMacroPro/Services/LoggingService.cs](mdc:VoiceMacroPro/Services/LoggingService.cs)
- **ë°±ì—”ë“œ ë¡œê¹…**: Python logging ëª¨ë“ˆ ì‚¬ìš©
- **API ì‘ë‹µ ì‹œê°„ ì¸¡ì •**: ìë™ ë¡œê¹…

### ì„±ëŠ¥ ìµœì í™” í¬ì¸íŠ¸
- API ì‘ë‹µ ìºì‹±
- ëŒ€ìš©ëŸ‰ ë°ì´í„° í˜ì´ì§•
- ë¹„ë™ê¸° ìš”ì²­ ì²˜ë¦¬
- ì—°ê²° í’€ë§ ìµœì í™”

## ğŸ”§ ê°œë°œ ì„¤ì •

### í™˜ê²½ ë³€ìˆ˜
```bash
# API ì„œë²„ ì„¤ì •
API_HOST=127.0.0.1
API_PORT=5000
DEBUG_MODE=True

# ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
DB_PATH=voice_macro.db
```

### ì˜ì¡´ì„± ê´€ë¦¬
- **Python**: [requirements.txt](mdc:requirements.txt)
- **C#**: NuGet íŒ¨í‚¤ì§€ ê´€ë¦¬ (.csproj íŒŒì¼)

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ
- **API ìƒì„¸ ëª…ì„¸**: [PRD_ê²Œì„AIìŒì„±ë§¤í¬ë¡œ.md](mdc:PRD_ê²Œì„AIìŒì„±ë§¤í¬ë¡œ.md) ì„¹ì…˜ 4
- **ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ**: [backend/database/database_manager.py](mdc:backend/database/database_manager.py)
